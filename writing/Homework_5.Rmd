---
title: "Homework 5- Due 11/30/2022"
author: "Lexi Keene"
date: '2022-11-14'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(tigris)
library(sf)
library(forcats)
library(ggthemes)
```

```{r, load data}
list.files("../data/")
homicide_data <- read_csv("../data/homicide-data.csv")
head(homicide_data)
```

```{r, clean data}
baltimore_data <- homicide_data %>% 
  filter(city == "Baltimore") %>% 
  mutate(reported_date = ymd(reported_date),
         year = year(reported_date),
         month = month(reported_date),
         day = day(reported_date)) %>% 
  mutate(solved = disposition == "Closed by arrest")

baltimore_data$solved <- as.factor(baltimore_data$solved)
baltimore_data <- baltimore_data %>% 
  mutate(solved = recode(solved, "0" = "Unsolved", "1" = "Solved"))
baltimore_data$victim_race <- as.factor(baltimore_data$victim_race)

baltimore_data$victim_race <- fct_lump(baltimore_data$victim_race, n = 3)
```

```{r, make sf object}
baltimore_tracts <- tracts("MD", "Baltimore city")
head(baltimore_tracts)

baltimore_sf  <- st_as_sf(baltimore_data, coords = c("lon", "lat")) %>% 
  st_set_crs(4269)
  
```


```{r}
ggplot() +
  geom_sf(data = baltimore_tracts) +
  geom_sf(data = baltimore_sf, aes(color = victim_race), alpha = 0.6) +
  facet_grid(. ~ solved) +
  theme_tufte() +
  labs(color = "Victim Race")
```
